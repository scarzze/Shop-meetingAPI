<<<<<<< HEAD

from greenlet import greenlet

from . import TestCase

class genlet(greenlet):
    parent = None
=======
import unittest
from greenlet import greenlet


class genlet(greenlet):

>>>>>>> Salma
    def __init__(self, *args, **kwds):
        self.args = args
        self.kwds = kwds

    def run(self):
        fn, = self.fn
        fn(*self.args, **self.kwds)

    def __iter__(self):
        return self

    def __next__(self):
        self.parent = greenlet.getcurrent()
        result = self.switch()
        if self:
            return result
<<<<<<< HEAD

        raise StopIteration

=======
        else:
            raise StopIteration

    # Hack: Python < 2.6 compatibility
>>>>>>> Salma
    next = __next__


def Yield(value):
    g = greenlet.getcurrent()
    while not isinstance(g, genlet):
        if g is None:
            raise RuntimeError('yield outside a genlet')
        g = g.parent
    g.parent.switch(value)


def generator(func):
<<<<<<< HEAD
    class Generator(genlet):
        fn = (func,)
    return Generator
=======
    class generator(genlet):
        fn = (func,)
    return generator
>>>>>>> Salma

# ____________________________________________________________


<<<<<<< HEAD
class GeneratorTests(TestCase):
=======
class GeneratorTests(unittest.TestCase):
>>>>>>> Salma
    def test_generator(self):
        seen = []

        def g(n):
            for i in range(n):
                seen.append(i)
                Yield(i)
        g = generator(g)
<<<<<<< HEAD
        for _ in range(3):
=======
        for k in range(3):
>>>>>>> Salma
            for j in g(5):
                seen.append(j)
        self.assertEqual(seen, 3 * [0, 0, 1, 1, 2, 2, 3, 3, 4, 4])
